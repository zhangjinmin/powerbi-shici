var poemVisualEADD5C8E74F446A88849D7D4AC9C7593;(()=>{"use strict";var t={945(t,e,i){i.d(e,{b:()=>s});class s{target;textContainer;settings={color:"#333333",fontFamily:"Microsoft YaHei",opacity:100,textAlign:"center",bold:!1,italic:!1,underline:!1,showShadow:!1,shadowColor:"#000000",resizeMode:"auto",fontSize:24};constructor(t){this.target=t.element,this.textContainer=document.createElement("div"),this.textContainer.classList.add("poem-text"),this.textContainer.innerText="加载中...",this.target.appendChild(this.textContainer),this.fetchPoem()}async fetchPoem(){try{const t="https://v1.jinrishici.com/all.txt",e=await fetch(t);if(!e.ok)throw new Error("Network error");const i=await e.text();this.textContainer.innerText=i}catch(t){this.textContainer.innerText="加载失败"}}update(t){t.dataViews&&t.dataViews[0]&&this.parseSettings(t.dataViews[0]);let e=this.settings.fontSize;if("auto"===this.settings.resizeMode){const i=t.viewport.width,s=t.viewport.height;e=Math.min(i,s)/2,e<12&&(e=12)}const i=this.textContainer.style;i.color=this.settings.color,i.fontFamily=this.settings.fontFamily,i.opacity=(this.settings.opacity/100).toString(),i.fontSize=e+"px",i.textAlign=this.settings.textAlign,"left"===this.settings.textAlign?i.justifyContent="flex-start":"right"===this.settings.textAlign?i.justifyContent="flex-end":i.justifyContent="center",i.fontWeight=this.settings.bold?"bold":"normal",i.fontStyle=this.settings.italic?"italic":"normal",i.textDecoration=this.settings.underline?"underline":"none",this.settings.showShadow?i.textShadow=`2px 2px 4px ${this.settings.shadowColor}`:i.textShadow="none"}enumerateObjectInstances(t){const e=t.objectName,i=[];return"styleSettings"===e&&i.push({objectName:e,properties:{textColor:this.settings.color,fontFamily:this.settings.fontFamily,textOpacity:this.settings.opacity,textAlign:this.settings.textAlign,bold:this.settings.bold,italic:this.settings.italic,underline:this.settings.underline,showShadow:this.settings.showShadow,shadowColor:this.settings.shadowColor,resizeMode:this.settings.resizeMode,fontSize:this.settings.fontSize},selector:null}),i}parseSettings(t){const e="styleSettings",i=t.metadata;if(i&&i.objects&&i.objects[e]){const t=i.objects[e];if(t.textColor){const e=t.textColor;e.solid&&e.solid.color&&(this.settings.color=e.solid.color)}if(t.shadowColor){const e=t.shadowColor;e.solid&&e.solid.color&&(this.settings.shadowColor=e.solid.color)}t.fontFamily&&(this.settings.fontFamily=t.fontFamily),void 0!==t.textOpacity&&(this.settings.opacity=t.textOpacity),t.textAlign&&(this.settings.textAlign=t.textAlign),void 0!==t.bold&&(this.settings.bold=t.bold),void 0!==t.italic&&(this.settings.italic=t.italic),void 0!==t.underline&&(this.settings.underline=t.underline),void 0!==t.showShadow&&(this.settings.showShadow=t.showShadow),t.resizeMode&&(this.settings.resizeMode=t.resizeMode),t.fontSize&&(this.settings.fontSize=t.fontSize)}}}}},e={};function i(s){var o=e[s];if(void 0!==o)return o.exports;var n=e[s]={exports:{}};return t[s](n,n.exports,i),n.exports}i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};(()=>{i.r(s),i.d(s,{default:()=>n});var t=i(945),e=window.powerbi,o={name:"poemVisualEADD5C8E74F446A88849D7D4AC9C7593",displayName:"PoemVisual",class:"Visual",apiVersion:"5.1.0",create:e=>{if(t.b)return new t.b(e);throw"Visual instance not found"},createModalDialog:(t,e,i)=>{const s=globalThis.dialogRegistry;t in s&&new s[t](e,i)},custom:!0};void 0!==e&&(e.visuals=e.visuals||{},e.visuals.plugins=e.visuals.plugins||{},e.visuals.plugins.poemVisualEADD5C8E74F446A88849D7D4AC9C7593=o);const n=o})(),poemVisualEADD5C8E74F446A88849D7D4AC9C7593=s})();